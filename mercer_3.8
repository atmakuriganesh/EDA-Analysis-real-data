from IPython.display import display
import pandas as pd

def compare_dataframe_columns(df_IW, df_OW):
    """
    Compare column counts between two dataframes and return a DataFrame
    showing comparison results along with match counts.
    
    Parameters:
    df_IW (DataFrame): First dataframe (IW)
    df_OW (DataFrame): Second dataframe (OW)
    
    Returns:
    tuple: (result_df, match_count, no_match_count) containing:
        - DataFrame with comparison results
        - Count of matching columns
        - Count of non-matching columns
    """
    # Get all unique column names from both datasets
    all_columns = set(df_IW.columns).union(set(df_OW.columns))
    
    # Initialize results list
    comparison_result = []
    match_count = 0
    no_match_count = 0
    
    # Compare counts for each column
    for column in all_columns:
        # Get count for each dataset, considering all rows
        iw_count = df_IW[column].count() if column in df_IW else "NA"
        ow_count = df_OW[column].count() if column in df_OW else "NA"
        
        # Compare counts
        if iw_count == ow_count:
            match = "Match"
            match_count += 1
        else:
            match = "No Match"
            no_match_count += 1
            
        # Append results
        comparison_result.append([column, iw_count, ow_count, match])
    
    # Convert results into DataFrame
    result_df = pd.DataFrame(comparison_result, columns=["Column Name", "IW Count", "OW Count", "Compare Result"])
    
    return result_df, match_count, no_match_count

def display_comparison_results(df_IW, df_OW):
    """
    Compare dataframe columns, display the results, and print match/no match counts.
    
    Parameters:
    df_IW (DataFrame): First dataframe (IW)
    df_OW (DataFrame): Second dataframe (OW)
    """
    result_df, match_count, no_match_count = compare_dataframe_columns(df_IW, df_OW)
    display(result_df)
    
    print(f"Match count: {match_count}")
    print(f"No Match count: {no_match_count}")
    print(f"Total columns compared: {match_count + no_match_count}")

# Call the function with your dataframes
display_comparison_results(df_IW, df_OW)
