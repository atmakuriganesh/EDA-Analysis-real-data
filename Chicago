if all_data:
    final_df = result_df.groupby('Job_code').agg({
        'Grade': 'first',  # Keep NaN
        'Min Rate': 'min',
        'Max Rate': 'max',
        'Pay Schedule Filename': 'first'
    }).reset_index()
else:
    final_df = result_df
