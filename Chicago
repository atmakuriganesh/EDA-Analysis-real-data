for grade, values in annual_data.items():
    if values:
        # Get all values as a flat list of numbers
        numeric_values = []
        for v in values:
            try:
                if v != '':
                    numeric_values.append(float(v))
            except (ValueError, TypeError):
                continue
                
        if numeric_values:
            min_rate = int(min(numeric_values))
            max_rate = max(numeric_values)  # Keep as int or round as needed
            
            all_data.append({
                'Grade': grade,
                'min rate': min_rate,
                'max rate': int(max_rate),
                'category': filename
            })
