# Show rows where Min Rate is missing
unmatched = final_df[final_df['Min Rate'].isna()]
print(unmatched[['Grade_Match', 'Pay Schedule Filename']].drop_duplicates())


# Create a set of keys from cook_county_df
cook_keys = set(zip(cook_county_df['Grade'], cook_county_df['Pay Schedule Filename']))

# Function to check if each key in unmatched exists in cook_county_df
def check_match(row):
    return (row['Grade_Match'], row['Pay Schedule Filename']) in cook_keys

# Apply to unmatched rows
unmatched['Key_Exists'] = unmatched.apply(check_match, axis=1)
print(unmatched[['Grade_Match', 'Pay Schedule Filename', 'Key_Exists']])
