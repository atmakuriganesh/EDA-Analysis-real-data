df2 = dataframes_1["RETRO PAYP033 SEIU Local 20 CCHHS Stroger Doctors Gr. KP1-4, DP4.xlsx_KP2 2023"]
# Step 1: Remove the first 6 rows
df2 = df2.iloc[6:]

# Step 2: Set the 7th row (now the first row) as column headers
new_headers = df2.iloc[0].values
df2 = df2.iloc[1:].reset_index(drop=True)
df2.columns = new_headers

# Step 3: Find all ANNUAL columns and get the last one
annual_columns = [col for col in df2.columns if isinstance(col, str) and "ANNUAL" in str(col).upper()]
last_annual_col = annual_columns[-1]  # This will select the rightmost ANNUAL column

# Step 4: Keep only the columns "OLD GRADE", "CURRENT GRADE", "STEP", and the last "ANNUAL"
df2 = df2[['OLD GRADE', 'CURRENT GRADE', 'STEP', last_annual_col]]

# Rename the last ANNUAL column to standardize it
df2 = df2.rename(columns={last_annual_col: 'ANNUAL'})

dataframes_1["RETRO PAYP033 SEIU Local 20 CCHHS Stroger Doctors Gr. KP1-4, DP4.xlsx_KP2 2023"] = df2
