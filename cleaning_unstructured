import pandas as pd

def extract_2023_data(df, category_name="category_name"):
    """
    Extracts rows containing '2023' and filters only 'Annual' term data.
    
    Parameters:
        df (pd.DataFrame): The input DataFrame.
        category_name (str): The category name to assign in the 'afaf' column.
    
    Returns:
        pd.DataFrame: A filtered DataFrame with columns ['grade', 'Term', 'end_rate', 'afaf'].
    """
    # Filter rows that contain '2023' in any column
    df_2023 = df[df.apply(lambda row: row.astype(str).str.contains('2023', case=False, na=False)).any(axis=1)]
    
    # Select only rows where Term is 'Annual'
    df_2023 = df_2023[df_2023.iloc[:, 1].str.contains("Annual", case=False, na=False)]  # Adjust column index if needed
    
    # Extract relevant columns (assuming they are in positions 0, 1, and 2)
    df_2023 = df_2023.iloc[:, [0, 1, 2]]
    df_2023.columns = ['grade', 'Term', 'end_rate']

    # Add category column
    df_2023['afaf'] = category_name  

    return df_2023

# Example usage:
# df is your already loaded DataFrame
filtered_df = extract_2023_data(df, category_name="Pharmacy Group")
print(filtered_df)
