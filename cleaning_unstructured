def clean_dataframe(df):
    # Step 1: Remove the first 6 rows
    df = df.iloc[6:]
    
    # Step 2: Set the 7th row (now the first row) as column headers
    new_headers = df.iloc[0].values
    df = df.iloc[1:].reset_index(drop=True)
    
    # Convert new_headers to strings to ensure they're all string type
    new_headers = [str(header) for header in new_headers]
    df.columns = new_headers
    
    # Step 3: Find the last ANNUAL column
    annual_columns = [col for col in df.columns if "ANNUAL" in col.upper()]
    if annual_columns:
        last_annual_col = annual_columns[-1]
    else:
        raise ValueError("No ANNUAL column found in the dataframe")
    
    # Keep only the necessary columns
    df = df[['OLD GRADE', 'CURRENT GRADE', 'STEP', last_annual_col]]
    
    # Rename the last ANNUAL column
    column_mapping = {last_annual_col: 'ANNUAL'}
    df = df.rename(columns=column_mapping)
    
    # Direct conversion - since we know they're all numbers
    # First, make sure there are no empty or NaN values
    df['ANNUAL'] = df['ANNUAL'].fillna(0)
    df['STEP'] = df['STEP'].fillna(0)
    
    # Then convert to integers
    df['ANNUAL'] = df['ANNUAL'].astype(int)
    df['STEP'] = df['STEP'].astype(int)
    
    return df
